#summary USB Network Devices - 3G/CDMA

Настройка подключения 3G/CDMA модема

= Содержание =
 * [GUIUSBNetworkDevices3GCDMA#General_parameters General parameters]
  * [GUIUSBNetworkDevices3GCDMA#Set_as_WAN_Connection_Type_by_default Set as WAN Connection Type by default]
  * [GUIUSBNetworkDevices3GCDMA#Zero_CD_Configuration Zero CD Configuration]
 * [GUIUSBNetworkDevices3GCDMA#Modem_options Modem options]
  * [GUIUSBNetworkDevices3GCDMA#Modem_type Modem type]
  * [GUIUSBNetworkDevices3GCDMA#Username Username]
  * [GUIUSBNetworkDevices3GCDMA#Password Password]
  * [GUIUSBNetworkDevices3GCDMA#APN APN]
  * [GUIUSBNetworkDevices3GCDMA#Dial_Number Dial Number]
  * [GUIUSBNetworkDevices3GCDMA#Call_on_Demand Call on Demand]
  * [GUIUSBNetworkDevices3GCDMA#Idle_time_before_disconnect_(sec) Idle time before disconnect (sec)]
  * [GUIUSBNetworkDevices3GCDMA#MTU MTU]
  * [GUIUSBNetworkDevices3GCDMA#MRU MRU]
 * [GUIUSBNetworkDevices3GCDMA#Custom_USB_device_parameters Custom USB device parameters]
  * [GUIUSBNetworkDevices3GCDMA#USB_device_location_ID USB device location ID]
  * [GUIUSBNetworkDevices3GCDMA#Autodetect_device Autodetect device]
  * [GUIUSBNetworkDevices3GCDMA#Data_port Data port]
  * [GUIUSBNetworkDevices3GCDMA#User_interface_port  User interface port]
  * [GUIUSBNetworkDevices3GCDMA#USB_device_Vendor_ID_(0xabcd) USB device Vendor ID (0xabcd)]
  * [GUIUSBNetworkDevices3GCDMA#USB_device_Product_ID_(0xefgh) USB device Product ID (0xefgh)]
  * [GUIUSBNetworkDevices3GCDMA#USB_device_serial_speed_(usually_921600) USB device serial speed (usually 921600)]
 * [GUIUSBNetworkDevices3GCDMA#Additional_parameters Additional parameters]
  * [GUIUSBNetworkDevices3GCDMA#Additional_AT_commands Additional AT commands]
  * [GUIUSBNetworkDevices3GCDMA#Additional_pppd_options Additional pppd options]
  * [GUIUSBNetworkDevices3GCDMA#Enable_USB-Serial_drivers Enable USB-Serial drivers]
  * [GUIUSBNetworkDevices3GCDMA#Failure_event_script_name Failure event script name]
  * [GUIUSBNetworkDevices3GCDMA#Max_number_of_reconnection_attempts Max number of reconnection attempts]
-------

= Введение =
Параметры на этой странице позволяют настроить WAN-подключение с помощью USB-модемов и сотовых телефонов(dialup, GPRS/EDGE/UMTS/CDMA...).

-------
= General parameters =
== Set as WAN Connection Type by default ==
Флаг, позволяющий указать, что устройство 3G/CDMA является соединением WAN по умолчанию.

Отмеченное состояние означает, что параметр *WAN Connection Type:* на странице *IP Config - WAN & LAN* установлен в значение *USB-Modem*. Если убрать этот флаг, то параметр *WAN Connection Type:* будет установлен в значение *Auto*.

При изменения этого флага требуется перезагрузка маршрутизатора.

== Zero CD Configuration ==
Позволяет переключить USB-устройства, имеющие Zero CD – режим в режим модема. (Zero CD режим проявляется следующим образом: при подключении к компьютеру, на котором не установлены драйверы этого устройства, будет создан виртуальный CD-ROM с драйверами). Для переключения используется usb_modeswitch.

 * Not set – переключение устройства не производится.
 * Auto – при обнаружении устройства будет автоматически выполнено отключение Zero CD режима при наличии соответствующих правил переключения в базе usb-modeswitch-data маршрутизатора.
 * Config at /usr/local/etc/usb_modeswitch.conf – если правила переключения устройства отсутствуют, но известны для конкретного устройства, можно создать файл */usr/local/etc/usb_modeswitch.conf*

Проверить подключилось ли устройство в режиме модема можно командой *cat /proc/bus/usb/devices* или воспользоваться страницей *Status & Log - Diagnostic Information*.

_Значение по умолчанию: Auto_
-------
= Modem options =
== Modem type ==
Выбор типа модема

 * CDMA/EVDO – модемы SkyLink
 * GPRS/EDGE/UMTS/HSPDA – модемы МТС, Билайн, Мегафон. А также большинство сотовых телефонов.
 * Dialup – dialup-модемы для телефонных линий.
 * User defined – будет запущен скрипт дозвона, который должен находится в файле */usr/local/dial/dial*.

_Значение по умолчанию: GPRS/EDGE/UMTS/HSPDA_

== Username ==
Имя пользователя. 
 * SkyLink - mobile
 * MTS – mts
 * Билайн – beeline
 * Мегафон - gdata

_Значение по умолчанию: не установлено_

== Password ==
Пароль. 
 * SkyLink - internet
 * MTS – mts
 * Билайн – beeline
 * Мегафон - gdata

_Значение по умолчанию: не установлено_
== APN ==
Access Point Name – имя точки доступа
 * MTS – internet.mts.ru
 * Билайн – home.beeline.ru или internet.beeline.ru (в зависимости от тарифа).
 * Мегафон - internet

_Значение по умолчанию: не установлено_

== Dial Number ==
Номер дозвона. Для GPRS/EDGE/UMTS/HSPDA модемов применяются номера `*99***1#` или `*99#`

_Значение по умолчанию: не установлено_

== Call on Demand ==
Режим дозвона по запросу. Если параметр установлен в Yes, то будет использован специальный режим, при котором будет установлено первичное соединение, однако модем будет подключаться к линии только при появлении запросов к внешней сети.

_Значение по умолчанию: No_

== Idle time before disconnect (sec) ==
Время простоя в секундах до отсоединения модема. Целесообразно использовать совместно с параметром Call on Demand – Yes.

_Значение по умолчанию: 60 секунд_

== MTU ==
Maximum Transmission Unit

_Значение по умолчанию: 1492_

== MRU ==
Maximum Receive Unit

_Значение по умолчанию: 1492_
-------
= Custom USB device parameters =
== Autodetect device ==
Автоматическое определение USB-устройства по идентификаторам VID:PID. Если модем присутствует в базе известных модемов, его тип, идентификатор, порты обмена данными и информацией для пользователя будут настроены автоматически.

_Значение по умолчанию: Yes_

== USB device location ID ==
Позволяет выбрать устройство в соответствии с физическим портом USB. Выбранный номер не будет изменяться при добавлении других устройств.

Допустим как непосредственный ввод, так и выбор в таблице, открывающейся при нажатии на кнопку View.

_Значение по умолчанию: не установлено_

== Data port ==
USB-устройство может иметь несколько портов обмена (USB Endpoints). Порт обмена данными имеется у всех модемов и необходим для подключения к сети.

Если модем неизвестен, необходимо подобрать порт обмена данными. См. количество портов и их возможные номера в разделе USB Devices и USB devfs на странице http://my.router/Main_SysInfo_Content.asp

_Значение по умолчанию: 0_

== User interface port ==
Порт обмена информацие для пользователя предназначен для получения по запросу пользователя уровня радиосигнала, информации о сети, о трафике, а также для отправки и получения USSD-запросов.

Модем может не иметь этот порт.

_Значение по умолчанию: 0_

== USB device Vendor ID (0xabcd) ==
Идентификатор производителя устройства. Параметр не обязателен. Указывается в шестнадцатеричном коде с обязательным префиксом 0x.

_Значение по умолчанию: не установлено_

== USB device Product ID (0xefgh) ==
Идентификатор продукта. Параметр не обязателен. Указывается в шестнадцатеричном коде с обязательным префиксом 0x.

_Значение по умолчанию: не установлено_

== USB device serial speed (usually 921600) ==
Скорость обмена данными с USB-устройством. В зависимости от используемого драйвера, указанное значение может игнорироваться.

_Значение по умолчанию: 921600_
-------
= Additional parameters =
== Additional AT commands ==
Дополнительные строки инициализации модема. Могут быть использованы команды указания приоритета типа сети, например 3G для модема ZTE 626: AT+ZSNT=0,0,2

_Значение по умолчанию: не установлено_

== Additional pppd options ==
Дополнительные опции pppd

_Значение по умолчанию: не установлено_

== Enable USB-Serial drivers ==
Перед началом дозвона подключает драйверы USB-Serial (pl2303, ftdi_sio)

_Значение по умолчанию: Yes_

== Failure event script name ==
Имя аварийного скрипта, вызываемого в случае, если соединение установить не удается. Может быть использован для оповещение о невозможности подключения или действий, связанных с перезагрузкой оборудования. Если имя не задано – будет предпринята попытка запустить пользовательский файл */usr/local/sbin/post-3g-failure*.

Простейший вариант – имя reboot. Более сложный пример приводится http://wl500g.info/attachment.php?attachmentid=6704&d=1278335883

Скрипт вызывается с параметрами:
 * ifnum=$1 - interface number, may be used for example as "ppp$ifnum"
 * usbdev=$2 -  usb device, for example "/dev/usb/tts/0"
 * pppd_res=$3 - return code from pppd, for example 5 - pppd was exited with SIGINT, SIGTERM or SIGHUP.

Примечание: аварийный скрипт вызывается только в том случае, если израсходовано количество попыток подключения, задаваемое параметром Max number of reconnection attempts

_Значение по умолчанию: не установлено_

== Max number of reconnection attempts ==
Максимальное количество попыток подключения модема. Если установлено 0 – количество попыток не ограничено.

_Значение по умолчанию: 0_
